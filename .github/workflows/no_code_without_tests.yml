#.github/workflows/no_code_without_tests.yml

#üëâ –°–º—ã—Å–ª:
#–ù–µ–ª—å–∑—è –¥–æ–±–∞–≤–ª—è—Ç—å –∫–æ–¥, –µ—Å–ª–∏ –Ω–µ—Ç —Ç–µ—Å—Ç–æ–≤.

name: No Code Without Tests

on:
  pull_request:
    paths:
      - "src/**"
      - "tests/**"

jobs:
  code-test-check:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Detect changed files
        run: |
          git fetch origin main
          git diff --name-only origin/main...HEAD > changes.txt
          cat changes.txt

      - name: Enforce tests for code
        run: |
          if grep -q "^src/" changes.txt; then
            if ! grep -q "^tests/" changes.txt; then
              echo "‚ùå Code added or changed without tests"
              exit 1
            fi
          fi
